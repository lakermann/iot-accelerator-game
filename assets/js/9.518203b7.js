(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{361:function(t,e,a){"use strict";a.r(e);var r=a(25),s=Object(r.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setup"}},[t._v("#")]),t._v(" Setup")]),t._v(" "),a("h2",{attrs:{id:"tools"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#tools"}},[t._v("#")]),t._v(" Tools")]),t._v(" "),a("p",[t._v("Installation script: "),a("a",{attrs:{href:"https://github.com/lakermann/iot-accelerator-game/blob/main/deployment/cli-tools.sh",target:"_blank",rel:"noopener noreferrer"}},[t._v("cli-tools.sh"),a("OutboundLink")],1)]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Tool")]),t._v(" "),a("th",[t._v("Version")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("azure-cli")])]),t._v(" "),a("td",[t._v("2.22.1")]),t._v(" "),a("td",[t._v("Setup Azure backend infrastructure "),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn1",id:"fnref1"}},[t._v("[1]")])])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("mssql-tools")])]),t._v(" "),a("td",[t._v("17.7.1.1")]),t._v(" "),a("td",[t._v("Create database table "),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn2",id:"fnref2"}},[t._v("[2]")])])])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("heroku")])]),t._v(" "),a("td",[t._v("7.52.0")]),t._v(" "),a("td",[t._v("Setup and deploy frontend to heroku (optional)  "),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn3",id:"fnref3"}},[t._v("[3]")])])])])])]),t._v(" "),a("h2",{attrs:{id:"backend-services"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#backend-services"}},[t._v("#")]),t._v(" Backend Services")]),t._v(" "),a("h3",{attrs:{id:"azure-resources"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#azure-resources"}},[t._v("#")]),t._v(" Azure Resources")]),t._v(" "),a("ul",[a("li",[t._v("Resource Group\n"),a("ul",[a("li",[t._v("Event Hubs Namespace "),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn4",id:"fnref4"}},[t._v("[4]")])]),t._v(" "),a("ul",[a("li",[t._v("Event Hub\n"),a("ul",[a("li",[t._v('Authorization Rule "Sensor" (Send)')]),t._v(" "),a("li",[t._v('Authorization Rule "Stream Analytics" (Listen)')])])])])]),t._v(" "),a("li",[t._v("SQL Server "),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn5",id:"fnref5"}},[t._v("[5]")])]),t._v(" "),a("ul",[a("li",[t._v("SQL Database\n"),a("ul",[a("li",[t._v('Firewall Rule "Azure Services"')]),t._v(" "),a("li",[t._v('Firewall Rule "Cli"')])])])])]),t._v(" "),a("li",[t._v("Stream Analytics Job "),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn6",id:"fnref6"}},[t._v("[6]")])]),t._v(" "),a("ul",[a("li",[t._v('Input "Event Hub"')]),t._v(" "),a("li",[t._v('Output "SQL Database"')]),t._v(" "),a("li",[t._v("Transformation "),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn7",id:"fnref7"}},[t._v("[7]")])])])])])])])]),t._v(" "),a("h3",{attrs:{id:"azure-deployment"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#azure-deployment"}},[t._v("#")]),t._v(" Azure Deployment")]),t._v(" "),a("p",[t._v("Deployment script: "),a("a",{attrs:{href:"https://github.com/lakermann/iot-accelerator-game/blob/main/deployment/backend-azure.sh",target:"_blank",rel:"noopener noreferrer"}},[t._v("backend-azure.sh"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("Usage: ./backend-azure.sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("command"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nwhere "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("command"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" is one of the following\n  create\n  cleanup\n")])])]),a("ul",[a("li",[a("code",[t._v("create")]),t._v(": create all needed resources in a new resource group in an already existing subscription")]),t._v(" "),a("li",[a("code",[t._v("cleanup")]),t._v(": delete the resource group with all resources")])]),t._v(" "),a("h4",{attrs:{id:"configuration-azure-script"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration-azure-script"}},[t._v("#")]),t._v(" Configuration Azure Script")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Property")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("subscription")])]),t._v(" "),a("td",[t._v("Name or ID of subscription.")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("event_hubs_namespace")])]),t._v(" "),a("td",[t._v("Event hub namespace, provides network endpoints.")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("mssql_server_admin_user")])]),t._v(" "),a("td",[t._v("Administrator username for the server.")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("mssql_server_admin_password")])]),t._v(" "),a("td",[t._v("Administrator login password.")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("mssql_server_ip_whitelist")])]),t._v(" "),a("td",[t._v("IPv4 address of the firewall rule, used for database access.")])])])]),t._v(" "),a("h4",{attrs:{id:"output"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#output"}},[t._v("#")]),t._v(" Output")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("MSSQL connection details\n  Host: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n  Database: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\nEvent Hub connection details\n  URI: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n  SAS Token: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("validity: "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),t._v(" hours"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),a("h2",{attrs:{id:"frontend"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#frontend"}},[t._v("#")]),t._v(" Frontend")]),t._v(" "),a("p",[t._v("Vue.js"),a("sup",{staticClass:"footnote-ref"},[a("a",{attrs:{href:"#fn8",id:"fnref8"}},[t._v("[8]")])]),t._v(" web app to collect and push accelerometer events.")]),t._v(" "),a("h3",{attrs:{id:"local-development"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#local-development"}},[t._v("#")]),t._v(" Local Development")]),t._v(" "),a("h4",{attrs:{id:"configuration-env"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration-env"}},[t._v("#")]),t._v(" Configuration "),a("code",[t._v(".env")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Property")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("VUE_APP_POST_INTERVAL")])]),t._v(" "),a("td",[t._v("Http post interval (ms)")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("VUE_APP_POST_URL")])]),t._v(" "),a("td",[t._v("Http post url (event hub URI)")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("VUE_APP_POST_AUTHORIZATION_HEADER")])]),t._v(" "),a("td",[t._v("Http post access token (event hub SAS Token)")])])])]),t._v(" "),a("h3",{attrs:{id:"heroku-deployment"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#heroku-deployment"}},[t._v("#")]),t._v(" Heroku Deployment")]),t._v(" "),a("p",[t._v("Deployment script: "),a("a",{attrs:{href:"https://github.com/lakermann/iot-accelerator-game/blob/main/deployment/frontend-heroku.sh",target:"_blank",rel:"noopener noreferrer"}},[t._v("frontend-heroku.sh"),a("OutboundLink")],1)]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("Usage: ./frontend-heroku.sh "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("command"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nwhere "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("command"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" is one of the following\n  init\n  create\n")])])]),a("ul",[a("li",[a("code",[t._v("create")]),t._v(": create heroku app")]),t._v(" "),a("li",[a("code",[t._v("cleanup")]),t._v(": destroy heroku app")])]),t._v(" "),a("h4",{attrs:{id:"configuration-heroku-script"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#configuration-heroku-script"}},[t._v("#")]),t._v(" Configuration Heroku Script")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",[t._v("Property")]),t._v(" "),a("th",[t._v("Description")])])]),t._v(" "),a("tbody",[a("tr",[a("td",[a("code",[t._v("application_name")])]),t._v(" "),a("td",[t._v("Heroku application name")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("post_interval")])]),t._v(" "),a("td",[t._v("Http post interval (ms)")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("post_url")])]),t._v(" "),a("td",[t._v("Http post url (event hub URI)")])]),t._v(" "),a("tr",[a("td",[a("code",[t._v("post_authorization_header")])]),t._v(" "),a("td",[t._v("Http post access token (event hub SAS Token)")])])])]),t._v(" "),a("p",[t._v("In this demo project, the secrets are stored in the app. Usually do not store any secrets (such as private API keys) in\nyour app! Environment variables are embedded into the build, meaning anyone can view them by inspecting your app's\nfiles.")]),t._v(" "),a("h2",{attrs:{id:"ranking"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ranking"}},[t._v("#")]),t._v(" Ranking")]),t._v(" "),a("div",{staticClass:"language-sql extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("SELECT")]),t._v(" username"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("AVG")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("acceleration_magnitude"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("AS")]),t._v(" average_acceleration_magnitude\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("FROM")]),t._v(" METRICS\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("GROUP")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" username\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("ORDER")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("BY")]),t._v(" average_acceleration_magnitude "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("DESC")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),a("hr",{staticClass:"footnotes-sep"}),t._v(" "),a("section",{staticClass:"footnotes"},[a("ol",{staticClass:"footnotes-list"},[a("li",{staticClass:"footnote-item",attrs:{id:"fn1"}},[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/cli/azure/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.microsoft.com/en-us/cli/azure/"),a("OutboundLink")],1),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref1"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn2"}},[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/sql/tools/sqlcmd-utility",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.microsoft.com/en-us/sql/tools/sqlcmd-utility"),a("OutboundLink")],1),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref2"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn3"}},[a("p",[a("a",{attrs:{href:"https://devcenter.heroku.com/articles/heroku-cli",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://devcenter.heroku.com/articles/heroku-cli"),a("OutboundLink")],1),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref3"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn4"}},[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/azure/event-hubs/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.microsoft.com/en-us/azure/event-hubs/"),a("OutboundLink")],1),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref4"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn5"}},[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/azure/azure-sql/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.microsoft.com/en-us/azure/azure-sql/"),a("OutboundLink")],1),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref5"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn6"}},[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/azure/stream-analytics/",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.microsoft.com/en-us/azure/stream-analytics/"),a("OutboundLink")],1),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref6"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn7"}},[a("p",[a("a",{attrs:{href:"https://docs.microsoft.com/en-us/stream-analytics-query/stream-analytics-query-language-reference",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://docs.microsoft.com/en-us/stream-analytics-query/stream-analytics-query-language-reference"),a("OutboundLink")],1),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref7"}},[t._v("↩︎")])])]),t._v(" "),a("li",{staticClass:"footnote-item",attrs:{id:"fn8"}},[a("p",[a("a",{attrs:{href:"https://vuejs.org",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://vuejs.org"),a("OutboundLink")],1),t._v(" "),a("a",{staticClass:"footnote-backref",attrs:{href:"#fnref8"}},[t._v("↩︎")])])])])])])}),[],!1,null,null,null);e.default=s.exports}}]);